[gcode_macro M203]
description: Set maximum feedrate (Marlin)
gcode:
    # M203 sets the maximum feedrate (speed) for axes in Marlin. This macro adapts it for Klipper.
    {% if 'X' in params %}
        SET_VELOCITY_LIMIT VELOCITY={params.X}
        {action_respond_info("Set maximum X feedrate to {params.X} mm/s")}
    {% endif %}
    {% if 'Y' in params %}
        SET_VELOCITY_LIMIT VELOCITY={params.Y}
        {action_respond_info("Set maximum Y feedrate to {params.Y} mm/s")}
    {% endif %}
    {% if 'Z' in params %}
        SET_VELOCITY_LIMIT VELOCITY={params.Z}
        {action_respond_info("Set maximum Z feedrate to {params.Z} mm/s")}
    {% endif %}
    {% if 'E' in params %}
        SET_VELOCITY_LIMIT EXTRUDER={params.E}
        {action_respond_info("Set maximum extruder feedrate to {params.E} mm/s")}
    {% endif %}
    {% if 'X' not in params and 'Y' not in params and 'Z' not in params and 'E' not in params %}
        {action_respond_info("M203 command received without parameters. No feedrate changes applied.")}
    {% endif %}
