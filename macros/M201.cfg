[gcode_macro M201]
description: Set maximum acceleration (Marlin)
gcode:
    # M201 sets the maximum acceleration in Marlin. This macro adapts it for Klipper.
    {% if 'X' in params %}
        SET_VELOCITY_LIMIT ACCEL={params.X}
        {action_respond_info("Set maximum X acceleration to {params.X}")}
    {% endif %}
    {% if 'Y' in params %}
        SET_VELOCITY_LIMIT ACCEL={params.Y}
        {action_respond_info("Set maximum Y acceleration to {params.Y}")}
    {% endif %}
    {% if 'Z' in params %}
        SET_VELOCITY_LIMIT ACCEL={params.Z}
        {action_respond_info("Set maximum Z acceleration to {params.Z}")}
    {% endif %}
    {% if 'E' in params %}
        SET_VELOCITY_LIMIT EXTRUDER={params.E}
        {action_respond_info("Set maximum extruder acceleration to {params.E}")}
    {% endif %}
    {% if 'X' not in params and 'Y' not in params and 'Z' not in params and 'E' not in params %}
        {action_respond_info("M201 command received without parameters. No acceleration changes applied.")}
    {% endif %}
