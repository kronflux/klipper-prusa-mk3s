[gcode_macro M205]
description: Set advanced motion settings (Marlin)
gcode:
  {% if 'X' in params %}
    {% set x_velocity = params.X|float %}
    SET_VELOCITY_LIMIT SQUARE_CORNER_VELOCITY={x_velocity}
    {action_respond_info("Set square corner velocity to " ~ x_velocity ~ " mm/s")}
  {% endif %}
  {% if 'Y' in params %}
    {% set y_velocity = params.Y|float %}
    SET_VELOCITY_LIMIT SQUARE_CORNER_VELOCITY={y_velocity}
    {action_respond_info("Set square corner velocity to " ~ y_velocity ~ " mm/s")}
  {% endif %}
  {% if 'Z' in params %}
    {% set z_accel_to_decel = params.Z|float %}
    SET_VELOCITY_LIMIT MAX_ACCEL_TO_DECEL={z_accel_to_decel}
    {action_respond_info("Set max acceleration to deceleration to " ~ z_accel_to_decel ~ " mm/sÂ²")}
  {% endif %}
  {% if 'E' in params %}
    {% set e_max_velocity = params.E|float %}
    SET_VELOCITY_LIMIT EXTRUDER_MAX_VELOCITY={e_max_velocity}
    {action_respond_info("Set extruder max velocity to " ~ e_max_velocity ~ " mm/s")}
  {% endif %}
  {% if 'X' not in params and 'Y' not in params and 'Z' not in params and 'E' not in params %}
    {action_respond_info("M205 command received without parameters. No changes applied.")}
  {% endif %}
