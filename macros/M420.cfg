[gcode_macro M420]
description: Enable or disable bed leveling (Marlin)
gcode:
    {% if 'S' in params %}
        {% if params.S|int == 1 %}
            BED_MESH_PROFILE LOAD=default
            {action_respond_info("Bed leveling enabled.")}
        {% elif params.S|int == 0 %}
            BED_MESH_CLEAR
            {action_respond_info("Bed leveling disabled.")}
        {% else %}
            {action_respond_info("Invalid parameter for M420. Use S1 to enable or S0 to disable bed leveling.")}
        {% endif %}
    {% else %}
        {action_respond_info("M420 command received without 'S' parameter. Use S1 to enable or S0 to disable bed leveling.")}
    {% endif %}
